<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Agentic Twins ‚Äî Global Air Network (Premium)</title>

  <link href="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.css" rel="stylesheet" />

  <style>
    :root{
      --bg0:#070b17;
      --bg1:#0b1630;
      --glass: rgba(255,255,255,.10);
      --glass2: rgba(255,255,255,.14);
      --stroke: rgba(255,255,255,.18);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --accent: #4dd7ff;
      --good: #00d08a;
      --bad: #ff5a6a;
      --shadow: 0 16px 48px rgba(0,0,0,.45);
    }

    html, body { height: 100%; margin: 0; }
    body{
      background:
        radial-gradient(1200px 650px at 20% 18%, rgba(77,215,255,.12), transparent 55%),
        radial-gradient(900px 550px at 78% 28%, rgba(0,208,138,.10), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      overflow: hidden;
    }

    #stage{ position: relative; width:100%; height:100%; }
    #map{ position:absolute; inset:0; }

    /* Top control bar (glass) */
    #ui{
      position: fixed;
      top: 14px;
      left: 14px;
      display:flex;
      gap: 10px;
      z-index: 10;
      padding: 10px;
      border-radius: 18px;
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.08));
      box-shadow: 0 10px 28px rgba(0,0,0,.30);
      backdrop-filter: blur(12px);
    }
    #ui button{
      background: rgba(255,255,255,.08);
      color: var(--text);
      border: 1px solid rgba(255,255,255,.16);
      padding: 10px 12px;
      border-radius: 14px;
      cursor:pointer;
      font: 800 13px/1 system-ui;
      letter-spacing:.2px;
      display:flex; gap:8px; align-items:center;
      user-select:none;
    }
    #ui button:hover{ background: rgba(255,255,255,.12); }
    #ui button.primary{
      border-color: rgba(77,215,255,.40);
      background: rgba(77,215,255,.16);
    }
    #ui button.good{
      border-color: rgba(0,208,138,.42);
      background: rgba(0,208,138,.14);
    }
    #ui button.bad{
      border-color: rgba(255,90,106,.42);
      background: rgba(255,90,106,.14);
    }

    /* Stats panel */
    #stats{
      position: fixed;
      right: 14px; bottom: 14px;
      width: 520px; max-height: 58vh; overflow:auto;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border: 1px solid var(--stroke);
      border-radius: 18px;
      padding: 14px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      z-index: 10;
      transform: translateY(0);
      opacity: 1;
      transition: transform .18s ease, opacity .18s ease;
    }
    #stats.collapsed{
      transform: translateY(18px);
      opacity: 0;
      pointer-events: none;
    }
    #stats h3{
      margin:0 0 10px 0;
      font: 900 14px/1.2 system-ui;
      display:flex; align-items:center; justify-content:space-between;
      letter-spacing:.2px;
    }
    #stats h3 .pill{
      font: 800 11px/1 system-ui;
      padding: 6px 9px;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.14);
      color: var(--muted);
    }
    #stats table{ width:100%; border-collapse: collapse; }
    #stats th, #stats td{
      padding: 7px 6px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      font-size: 12px;
    }
    #stats th{ color: var(--muted); text-align:left; font-weight: 800; }
    #stats .pos{ color: var(--good); font-weight: 900; }
    #stats .neg{ color: var(--bad); font-weight: 900; }

    /* Bottom-left instruction toast */
    #toast{
      position: fixed;
      left: 14px;
      bottom: 14px;
      max-width: 560px;
      padding: 12px 14px;
      border-radius: 16px;
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.08));
      box-shadow: 0 10px 28px rgba(0,0,0,.30);
      backdrop-filter: blur(12px);
      z-index: 10;
      color: var(--text);
      font: 650 13px/1.35 system-ui;
    }
    #toast small{ display:block; margin-top:6px; color: var(--muted); font-weight:600; }

    @media(max-width: 820px){
      #stats{ width: calc(100% - 28px); }
      #toast{ max-width: calc(100% - 28px); }
    }
  </style>
</head>

<body>
  <main id="stage">
    <div id="ui">
      <button id="btnNormal" class="primary">üü¶ Normal</button>
      <button id="btnHub" class="primary">üü® Hub Dubai</button>
      <button id="btnDisrupt" class="bad">üü• Disrupt</button>
      <button id="btnCorrect" class="good">üü© Correct</button>
      <button id="btnAddParis">‚ûï Add Paris</button>
      <button id="btnAddVienna">‚ûï Add Vienna</button>
      <button id="btnToggleStats">üìä Dashboard</button>
      <button id="btnMute">üîä Narration</button>
    </div>

    <div id="stats">
      <h3>Predicted Dashboard Status <span class="pill" id="scenarioPill">Normal operations</span></h3>
      <table id="statsTable">
        <thead>
          <tr>
            <th>City</th>
            <th>Flights</th>
            <th class="pos">Active</th>
            <th class="neg">Paused</th>
            <th>Capacity (t)</th>
            <th>Time (hrs)</th>
            <th>Fuel (t)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div id="toast">
      Use the top buttons to drive the simulation: <b>Hub Dubai</b>, <b>Disrupt</b>, <b>Correct</b>, <b>Normal</b>.
      <small>Tip: click anywhere once to enable narration (browser policy). Then press ‚ÄúNarration‚Äù.</small>
    </div>

    <div id="map"></div>
  </main>

  <script src="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.js"></script>
  <script src="https://unpkg.com/@turf/turf@6.5.0/turf.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
